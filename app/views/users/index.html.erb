<% title "Stores", false %>

<div id="search">
  <% form_tag search_url, :name => "sitesearch", :method => 'get' do %>
    <div class="input">
      <%= text_field_tag :q, params[:q], :autocomplete => "off", :size => "25" %>
    </div>
    <div class="submit">
      <a href="javascript:document.sitesearch.submit()" style="cursor:default"><%= image_tag 'search.gif' %></a>
      <%= submit_tag t('search.search'), :name => nil %>
    </div>
    <div class="type clear">
      <%= radio_button_tag 'type', "products", true %><%= label_tag "type_products", t('activerecord.models.product') %>
      &nbsp;
      <%= radio_button_tag 'type', "stores" %><%= label_tag "type_stores", t('activerecord.models.user') %>
    </div>
  <% end %>
</div>

<% if @users.size == 0 %>
  <div class="store-listing">
    <%= t('search.no_stores_found') %>
  </div>
<% else %>
  <ul class="store-listing">
    <% for user in @users %>
      <li>
        <div class="image-shadow image">
	  <% unless user.products.empty? || user.products.first.images.empty? %>
	    <%= link_to image_tag(cloudfront(user.products.first.images.first.attachment.url(:mini))), store_path(user.username) %>
	  <% end %>
        </div>
        <div class="info">
          <div class="title">
            <% link_to store_path(user.username) do %>
	      <%= truncate h(user.store_name), 30 %> -
	      <%= truncate h(user.address), 30 %>
	    <% end %>
          </div>
          <div style="margin-top:3px">
	    <%= truncate h(user.description), 90 %>
          </div>
        </div>
      </li>
      <% end %>
  </ul>
<% end %>

<div id="pagination" class="clear">
  <%= will_paginate @users, :previous_label => t('pagination.previous'), :next_label => t('pagination.next') %>
</div>
